<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Login</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{
    box-sizing:border-box;
    font-family: "Segoe UI", system-ui, -apple-system;
}
body{
    margin:0;
    height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    background:linear-gradient(135deg,#4f46e5,#06b6d4);
}
.login-box{
    background:#fff;
    width:100%;
    max-width:380px;
    padding:30px;
    border-radius:14px;
    box-shadow:0 20px 40px rgba(0,0,0,.2);
}
.login-box h2{
    margin:0 0 20px;
    text-align:center;
}
.input{
    width:100%;
    padding:12px 14px;
    margin-bottom:14px;
    border-radius:10px;
    border:1px solid #ddd;
    font-size:15px;
}
.input:focus{
    outline:none;
    border-color:#4f46e5;
}
button{
    width:100%;
    padding:12px;
    border:none;
    border-radius:10px;
    background:#4f46e5;
    color:#fff;
    font-size:16px;
    cursor:pointer;
}
button:disabled{
    opacity:.7;
    cursor:not-allowed;
}
.msg{
    margin-top:14px;
    text-align:center;
    font-size:14px;
}
.msg.error{color:#dc2626;}
.msg.success{color:#16a34a;}
</style>
</head>

<body>

<div class="login-box">
    <h2>Login user</h2>

    <input type="email" id="email" class="input" placeholder="Email">
    <input type="password" id="password" class="input" placeholder="Password">

    <button id="btn" onclick="login()">Login</button>

    <div id="msg" class="msg"></div>
</div>

<script>
const API_URL = "https://edutechx.is-great.org/login.php";

function login(){
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();
    const msg = document.getElementById("msg");
    const btn = document.getElementById("btn");

    msg.textContent = "";
    msg.className = "msg";

    if(!email || !password){
        msg.textContent = "Email & password required";
        msg.classList.add("error");
        return;
    }

    btn.disabled = true;
    btn.textContent = "Please wait...";

    fetch(API_URL,{
        method:"POST",
        headers:{
            "Content-Type":"application/json"
        },
        body:JSON.stringify({ email, password })
    })
    .then(async res=>{
        if(!res.ok){
            const t = await res.text();
            throw new Error("HTTP "+res.status+" "+t);
        }
        return res.json();
    })
    .then(data=>{
        if(data.status==="success"){
            msg.textContent = "Welcome " + data.name;
            msg.className = "msg success";

            localStorage.setItem("uid", data.id);
            localStorage.setItem("name", data.name);

            // window.location.href = "dashboard.html";
        }else{
            msg.textContent = data.msg || "Login failed";
            msg.className = "msg error";
        }
    })
    .catch(err=>{
        console.error(err);
        msg.textContent = "Server / CORS error";
        msg.className = "msg error";
    })
    .finally(()=>{
        btn.disabled = false;
        btn.textContent = "Login";
    });
}
</script>

</body>
</html>
